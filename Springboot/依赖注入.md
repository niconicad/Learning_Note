### **Spring ä¾èµ–æ³¨å…¥ï¼ˆDIï¼‰æ–¹æ³•æ€»ç»“**

ä¾èµ–æ³¨å…¥ï¼ˆDependency Injection, DIï¼‰æ˜¯ Spring IoCï¼ˆæ§åˆ¶åè½¬ï¼‰çš„æ ¸å¿ƒå®ç°æ–¹å¼ï¼Œç”¨äºè§£è€¦ç»„ä»¶ä¹‹é—´çš„ä¾èµ–å…³ç³»ã€‚ä»¥ä¸‹æ˜¯ Spring ä¸­å¸¸ç”¨çš„ä¾èµ–æ³¨å…¥æ–¹æ³•åŠå…¶ç‰¹ç‚¹ï¼š

------

## **1. æ„é€ å™¨æ³¨å…¥ï¼ˆConstructor Injectionï¼‰**

### **è¯­æ³•**

java

å¤åˆ¶

```java
@Service
public class UserService {
    private final UserRepository userRepository;

    // æ„é€ å™¨æ³¨å…¥ï¼ˆSpring 4.3+ å¯çœç•¥ @Autowiredï¼‰
    public UserService(UserRepository userRepository) {
        this.userRepository = userRepository;
    }
}
```

### **ç‰¹ç‚¹**

âœ… **æ¨èæ–¹å¼**ï¼ˆSpring å®˜æ–¹æ¨èï¼‰
 âœ… â€‹**å¼ºåˆ¶ä¾èµ–**â€‹ï¼ˆ`final` å­—æ®µï¼Œé¿å… `NullPointerException`ï¼‰
 âœ… â€‹**ä¸å¯å˜å¯¹è±¡**â€‹ï¼ˆçº¿ç¨‹å®‰å…¨ï¼‰
 âœ… â€‹**æ˜“äºå•å…ƒæµ‹è¯•**â€‹ï¼ˆå¯æ‰‹åŠ¨ä¼ å…¥ Mock å¯¹è±¡ï¼‰

### **é€‚ç”¨åœºæ™¯**

- **å¼ºä¾èµ–**ï¼ˆå¿…é¡»çš„ä¾èµ–ï¼‰
- **å•ä¾‹ Bean**
- **éœ€è¦ä¸å¯å˜å¯¹è±¡æ—¶**

------

## **2. Setter æ³¨å…¥ï¼ˆSetter Injectionï¼‰**

### **è¯­æ³•**

java

å¤åˆ¶

```java
@Service
public class OrderService {
    private PaymentService paymentService;

    // Setter æ³¨å…¥
    @Autowired
    public void setPaymentService(PaymentService paymentService) {
        this.paymentService = paymentService;
    }
}
```

### **ç‰¹ç‚¹**

âœ… **å¯é€‰ä¾èµ–**ï¼ˆå…è®¸ `null`ï¼‰
 âœ… â€‹**çµæ´»æ€§é«˜**â€‹ï¼ˆå¯åŠ¨æ€æ›¿æ¢ä¾èµ–ï¼‰
 âŒ â€‹**å¯¹è±¡å¯èƒ½å¤„äºéƒ¨åˆ†åˆå§‹åŒ–çŠ¶æ€**â€‹ï¼ˆéœ€æ³¨æ„ NPEï¼‰

### **é€‚ç”¨åœºæ™¯**

- **å¯é€‰ä¾èµ–**
- **éœ€è¦åŠ¨æ€è°ƒæ•´ä¾èµ–æ—¶**

------

## **3. å­—æ®µæ³¨å…¥ï¼ˆField Injectionï¼‰**

### **è¯­æ³•**

java

å¤åˆ¶

```java
@Service
public class ProductService {
    @Autowired  // å­—æ®µæ³¨å…¥
    private InventoryService inventoryService;
}
```

### **ç‰¹ç‚¹**

âŒ **ä¸æ¨è**ï¼ˆSpring å®˜æ–¹ä¸æ¨èï¼‰
 âŒ â€‹**éšè—ä¾èµ–å…³ç³»**â€‹ï¼ˆéš¾ä»¥å‘ç°ä¾èµ–ï¼‰
 âŒ â€‹**éš¾ä»¥æµ‹è¯•**â€‹ï¼ˆéœ€åå°„æˆ– Spring å®¹å™¨ï¼‰
 âŒ â€‹**ç ´åå°è£…æ€§**â€‹ï¼ˆæ— æ³•ç”¨ `final`ï¼‰

### **é€‚ç”¨åœºæ™¯**

- **å¿«é€ŸåŸå‹å¼€å‘**ï¼ˆä¸æ¨èç”Ÿäº§ç¯å¢ƒï¼‰
- **é—ç•™ä»£ç ç»´æŠ¤**

------

## **4. æ–¹æ³•æ³¨å…¥ï¼ˆMethod Injectionï¼‰**

### **è¯­æ³•**

java

å¤åˆ¶

```java
@Configuration
public class AppConfig {
    @Bean  // æ–¹æ³•æ³¨å…¥ï¼ˆå·¥å‚æ–¹æ³•ï¼‰
    public DataSource dataSource() {
        return new HikariDataSource();
    }
}
```

### **ç‰¹ç‚¹**

âœ… **é€‚ç”¨äºå¤æ‚ Bean åˆ›å»º**ï¼ˆå¦‚ JDBC `DataSource`ï¼‰
 âœ… â€‹**å¯ç»“åˆ `@Conditional` æ¡ä»¶åŒ–åˆ›å»º**â€‹

### **é€‚ç”¨åœºæ™¯**

- **éœ€è¦è‡ªå®šä¹‰ Bean åˆå§‹åŒ–é€»è¾‘**
- **æ¡ä»¶åŒ– Bean åˆ›å»ºï¼ˆå¦‚ `@Profile`ï¼‰**

------

## **5. æ¥å£æ³¨å…¥ï¼ˆInterface Injectionï¼‰**

### **è¯­æ³•**

java

å¤åˆ¶

```java
public interface Injectable {
    void inject(Dependency dependency);
}

@Component
public class MyService implements Injectable {
    private Dependency dependency;

    @Override
    public void inject(Dependency dependency) {
        this.dependency = dependency;
    }
}
```

### **ç‰¹ç‚¹**

âŒ **ä¸å¸¸ç”¨**ï¼ˆSpring ä¸æ¨èï¼‰
 âŒ â€‹**ä¾µå…¥æ€§å¼º**â€‹ï¼ˆéœ€å®ç°ç‰¹å®šæ¥å£ï¼‰

### **é€‚ç”¨åœºæ™¯**

- **ç‰¹æ®Šæ¡†æ¶é›†æˆ**ï¼ˆå¦‚æ—§ç‰ˆ Java EEï¼‰

------

## **6. æ³¨è§£æ³¨å…¥ï¼ˆ`@Resource` / `@Inject`ï¼‰**

### **`@Resource`ï¼ˆJSR-250ï¼‰**

java

å¤åˆ¶

```java
@Service
public class CartService {
    @Resource(name = "discountService")  // æŒ‰åç§°æ³¨å…¥
    private DiscountService discountService;
}
```

âœ… **æŒ‰åç§°æ³¨å…¥**ï¼ˆ`name` å±æ€§ï¼‰
 âœ… â€‹**JDK æ ‡å‡†**â€‹ï¼ˆä¸ä¾èµ– Springï¼‰

### **`@Inject`ï¼ˆJSR-330ï¼‰**

java

å¤åˆ¶

```java
@Service
public class PaymentService {
    @Inject  // ç±»ä¼¼ @Autowired
    private CreditCardProcessor processor;
}
```

âœ… **æ ‡å‡† JSR-330**ï¼ˆå…¼å®¹é Spring ç¯å¢ƒï¼‰
 âœ… â€‹**åŠŸèƒ½ç±»ä¼¼ `@Autowired`**â€‹

------

## **æ€»ç»“å¯¹æ¯”**

| **æ³¨å…¥æ–¹å¼**    | **æ¨èåº¦** | **å¼ºåˆ¶ä¾èµ–** | **ä¸å¯å˜æ€§** | **æµ‹è¯•å‹å¥½** | **é€‚ç”¨åœºæ™¯**             |
| --------------- | ---------- | ------------ | ------------ | ------------ | ------------------------ |
| **æ„é€ å™¨æ³¨å…¥**  | â­â­â­â­â­      | âœ…            | âœ…            | âœ…            | å¼ºä¾èµ–ã€å•ä¾‹ã€ä¸å¯å˜å¯¹è±¡ |
| **Setter æ³¨å…¥** | â­â­â­        | âŒ            | âŒ            | âš ï¸            | å¯é€‰ä¾èµ–ã€åŠ¨æ€è°ƒæ•´       |
| **å­—æ®µæ³¨å…¥**    | â­          | âŒ            | âŒ            | âŒ            | ä¸æ¨èï¼ˆä»…åŸå‹å¼€å‘ï¼‰     |
| **æ–¹æ³•æ³¨å…¥**    | â­â­â­â­       | -            | -            | âœ…            | å¤æ‚ Bean åˆå§‹åŒ–         |
| **æ¥å£æ³¨å…¥**    | â­          | âŒ            | âŒ            | âŒ            | ç‰¹æ®Šæ¡†æ¶é›†æˆ             |
| **`@Resource`** | â­â­â­        | âŒ            | âŒ            | âš ï¸            | æŒ‰åç§°æ³¨å…¥               |
| **`@Inject`**   | â­â­â­â­       | âŒ            | âŒ            | âœ…            | æ ‡å‡† JSR-330             |

------

## **æœ€ä½³å®è·µ**

1. **ä¼˜å…ˆä½¿ç”¨æ„é€ å™¨æ³¨å…¥**ï¼ˆå¼ºåˆ¶ä¾èµ– + ä¸å¯å˜å¯¹è±¡ï¼‰ã€‚
2. **å¯é€‰ä¾èµ–ç”¨ Setter æ³¨å…¥**ï¼ˆåŠ¨æ€è°ƒæ•´ï¼‰ã€‚
3. **é¿å…å­—æ®µæ³¨å…¥**ï¼ˆéš¾ä»¥ç»´æŠ¤å’Œæµ‹è¯•ï¼‰ã€‚
4. **å¤æ‚åˆå§‹åŒ–ç”¨ `@Bean` æ–¹æ³•æ³¨å…¥**ã€‚
5. **è·¨æ¡†æ¶å…¼å®¹è€ƒè™‘ `@Resource` / `@Inject`**ã€‚

é€šè¿‡åˆç†é€‰æ‹©ä¾èµ–æ³¨å…¥æ–¹å¼ï¼Œå¯ä»¥ä½¿ä»£ç æ›´å¥å£®ã€å¯æµ‹è¯•ã€æ˜“ç»´æŠ¤ã€‚ğŸš€